//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by FastEndpoints.Generator.
//
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------
#pragma warning disable CS0618
#nullable enable

using System;
using System.CodeDom.Compiler;
using System.Collections.Generic;
using System.Diagnostics.CodeAnalysis;
using System.Runtime.CompilerServices;
using System.Threading;
using System.Threading.Tasks;
using FastEndpoints;

namespace Web;

/// <summary>
/// Module initializer that automatically registers the generated event publishers.
/// </summary>
file static class EventPublishersInitializer
{
    [ModuleInitializer]
    internal static void Initialize()
    {
        global::FastEndpoints.EventPublisherRegistry.RegisterGeneratedPublishers(EventPublishers.GetPublisher);
    }
}

/// <summary>
/// Auto-generated AOT-compatible event publishers.
/// Provides pre-compiled publish delegates for all discovered IEvent types,
/// eliminating the need for MakeGenericType and Expression.Compile() at runtime.
/// </summary>
[GeneratedCode("FastEndpoints.Generator.EventPublishersGenerator", "7.3.0.0")]
public static class EventPublishers
{
    /// <summary>
    /// Ensures AOT/trimming preserves EventBus&lt;T&gt; for all discovered event types.
    /// </summary>
    [DynamicDependency(DynamicallyAccessedMemberTypes.PublicMethods | DynamicallyAccessedMemberTypes.PublicConstructors, typeof(global::FastEndpoints.EventBus<global::TestCases.EventBusTest.TestEventBus>))]
    [DynamicDependency(DynamicallyAccessedMemberTypes.PublicMethods | DynamicallyAccessedMemberTypes.PublicConstructors, typeof(global::FastEndpoints.EventBus<global::TestCases.EventHandlingTest.NewItemAddedToStock>))]
    [DynamicDependency(DynamicallyAccessedMemberTypes.PublicMethods | DynamicallyAccessedMemberTypes.PublicConstructors, typeof(global::FastEndpoints.EventBus<global::TestCases.EventHandlingTest.SomeEvent>))]
    [DynamicDependency(DynamicallyAccessedMemberTypes.PublicMethods | DynamicallyAccessedMemberTypes.PublicConstructors, typeof(global::FastEndpoints.EventBus<global::TestCases.EventQueueTest.MyEvent>))]
    [DynamicDependency(DynamicallyAccessedMemberTypes.PublicMethods | DynamicallyAccessedMemberTypes.PublicConstructors, typeof(global::FastEndpoints.EventBus<global::TestCases.EventQueueTest.TestEventQueue>))]
    public static void EnsureAotPreservation() { }

    /// <summary>
    /// Pre-compiled publish delegates keyed by event type.
    /// </summary>
    private static readonly Dictionary<Type, Func<IEvent, Mode, CancellationToken, Task>> Publishers = new()
    {
        [typeof(global::TestCases.EventBusTest.TestEventBus)] = Publish_TestCases_EventBusTest_TestEventBus,
        [typeof(global::TestCases.EventHandlingTest.NewItemAddedToStock)] = Publish_TestCases_EventHandlingTest_NewItemAddedToStock,
        [typeof(global::TestCases.EventHandlingTest.SomeEvent)] = Publish_TestCases_EventHandlingTest_SomeEvent,
        [typeof(global::TestCases.EventQueueTest.MyEvent)] = Publish_TestCases_EventQueueTest_MyEvent,
        [typeof(global::TestCases.EventQueueTest.TestEventQueue)] = Publish_TestCases_EventQueueTest_TestEventQueue,
    };

    /// <summary>
    /// Gets the pre-compiled publish delegate for the specified event type.
    /// Returns null if no publisher was generated for this event type.
    /// </summary>
    /// <param name="eventType">The type of the event.</param>
    /// <returns>The publish delegate, or null if not found.</returns>
    public static Func<IEvent, Mode, CancellationToken, Task>? GetPublisher(Type eventType)
        => Publishers.TryGetValue(eventType, out var publisher) ? publisher : null;

    /// <summary>
    /// Attempts to publish an event using the pre-compiled delegate.
    /// </summary>
    /// <param name="eventModel">The event to publish.</param>
    /// <param name="waitMode">The wait mode for subscribers.</param>
    /// <param name="cancellation">Cancellation token.</param>
    /// <param name="task">The resulting task if a publisher was found.</param>
    /// <returns>True if a pre-compiled publisher was found and used.</returns>
    public static bool TryPublish(IEvent eventModel, Mode waitMode, CancellationToken cancellation, out Task? task)
    {
        if (Publishers.TryGetValue(eventModel.GetType(), out var publisher))
        {
            task = publisher(eventModel, waitMode, cancellation);
            return true;
        }
        task = null;
        return false;
    }

    /// <summary>
    /// Publishes an event of type <see cref="TestCases.EventBusTest.TestEventBus"/>.
    /// </summary>
    private static Task Publish_TestCases_EventBusTest_TestEventBus(IEvent eventModel, Mode waitMode, CancellationToken cancellation)
        => global::FastEndpoints.EventPublisherRegistry.PublishEvent((global::TestCases.EventBusTest.TestEventBus)eventModel, waitMode, cancellation);

    /// <summary>
    /// Publishes an event of type <see cref="TestCases.EventHandlingTest.NewItemAddedToStock"/>.
    /// </summary>
    private static Task Publish_TestCases_EventHandlingTest_NewItemAddedToStock(IEvent eventModel, Mode waitMode, CancellationToken cancellation)
        => global::FastEndpoints.EventPublisherRegistry.PublishEvent((global::TestCases.EventHandlingTest.NewItemAddedToStock)eventModel, waitMode, cancellation);

    /// <summary>
    /// Publishes an event of type <see cref="TestCases.EventHandlingTest.SomeEvent"/>.
    /// </summary>
    private static Task Publish_TestCases_EventHandlingTest_SomeEvent(IEvent eventModel, Mode waitMode, CancellationToken cancellation)
        => global::FastEndpoints.EventPublisherRegistry.PublishEvent((global::TestCases.EventHandlingTest.SomeEvent)eventModel, waitMode, cancellation);

    /// <summary>
    /// Publishes an event of type <see cref="TestCases.EventQueueTest.MyEvent"/>.
    /// </summary>
    private static Task Publish_TestCases_EventQueueTest_MyEvent(IEvent eventModel, Mode waitMode, CancellationToken cancellation)
        => global::FastEndpoints.EventPublisherRegistry.PublishEvent((global::TestCases.EventQueueTest.MyEvent)eventModel, waitMode, cancellation);

    /// <summary>
    /// Publishes an event of type <see cref="TestCases.EventQueueTest.TestEventQueue"/>.
    /// </summary>
    private static Task Publish_TestCases_EventQueueTest_TestEventQueue(IEvent eventModel, Mode waitMode, CancellationToken cancellation)
        => global::FastEndpoints.EventPublisherRegistry.PublishEvent((global::TestCases.EventQueueTest.TestEventQueue)eventModel, waitMode, cancellation);

}
